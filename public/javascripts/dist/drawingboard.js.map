{"version":3,"sources":["webpack:///webpack/bootstrap d3d034cf4ab2b98b8ed8","webpack:///./public/javascripts/apps/drawingboard/src/index.js","webpack:///./public/javascripts/apps/drawingboard/utils.js","webpack:///./public/javascripts/apps/drawingboard/~/microevent/microevent.js","webpack:///(webpack)/buildin/module.js","webpack:///./public/javascripts/apps/drawingboard/~/simple-undo/lib/simple-undo.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;AAED;AACA;AACA,EAAC;;AAED;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;;;;;;;;;AC/IA;AACA;AACA,uBAAsB,EAAE,eAAe,EAAE;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,qDAAqD;AACpE;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;;;;;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA,iBAAgB,gCAAgC;AAChD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA,gBAAe,kBAAkB;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;;;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACTA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;AACF;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,+BAA8B;AAC9B;;;;;;AAMA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,EAAC,I","file":"drawingboard.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Users/guoshencheng/Documents/OtherProject/map/public/javascripts/dist\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d3d034cf4ab2b98b8ed8\n **/","var utils = require('../utils')\nvar microevent = require('microevent')\nvar SimpleUndo = require('simple-undo')\n\nvar canvas = document.getElementById('drawingboard')\nvar color, \n  fillTolerance = 100,\n  size = 1\nvar data = {}\ndata.coords = {}\ndata.drawing = false\ncolor = '#000000'\n\nvar draw = function() {\n  if (data.isDrawing) {\n    var ctx = getContext()\n    var currentMid = getMidInputCoords(data.coords.current)\n    ctx.beginPath()\n    ctx.strokeStyle = color\n    ctx.moveTo(currentMid.x, currentMid.y)\n    ctx.quadraticCurveTo(data.coords.old.x, data.coords.old.y, data.coords.oldMid.x, data.coords.oldMid.y);\n\t  ctx.stroke();\n\t  data.coords.old = data.coords.current;\n\t\tdata.coords.oldMid = currentMid;\n  }\n  if (requestAnimationFrame) requestAnimationFrame(draw)\n}\n\ndraw()\n\ncanvas.on = function(event, cb) {\n  canvas.addEventListener(event, cb, false)\n}\n\ncanvas.on('touchstart', function(e) {\n  onTouchStart(e, getInputCoords(e))\n})\n\ncanvas.on('touchmove', function(e) {\n  onTouchMove(e, getInputCoords(e))\n})\n\ncanvas.on('touchend', function(e) {\n  onTouchStop(e, getInputCoords(e))\n})\n\nvar onTouchStart = function(e, coords) {\n  data.coords.current = data.coords.old = coords\n  data.coords.oldMid = getMidInputCoords(coords)\n  data.isDrawing = true\n  if (!requestAnimationFrame) draw()\n  e.stopPropagation()\n  e.preventDefault()\n}\n\nvar onTouchMove = function(e, coords) {\n  data.coords.current = coords\n  if (!requestAnimationFrame) draw()\n  e.stopPropagation()\n  e.preventDefault()\n}\n\nvar onTouchStop = function(e, coords) {\n  if (data.isDrawing && (!e.touches || e.touches.length === 0)) {\n    data,isDrawing = false\n    saveHistory()\n    e.stopPropagation()\n    e.preventDefault()\n  }\n}\n\nvar getInputCoords = function(e) {\n  e = e.originalEvent ? e.originalEvent : e\n  var rect = canvas.getBoundingClientRect()\n  var width = canvas.width\n  var height = canvas.height\n  var x, y\n  if (e.touches && e.touches.length == 1) {\n   \tx = e.touches[0].pageX\n\t  y = e.touches[0].pageY   \n  } else {\n    x = e.pageX\n    y = e.pageY\n  }\n  x = x - canvas.offsetLeft\n  y = y - canvas.offsetTop\n  x *= (width / rect.width)\n  y *= (height / rect.height)\n  return {x: x, y: y}\n}\n\nvar getMidInputCoords = function(coords) {\n  return {\n    x: data.coords.old.x + coords.x >> 1,\n    y: data.coords.old.y + coords.y >> 1\n  }\n}\n\n/**\n *  init history with simple-undo\n **/\nvar history = new SimpleUndo({\n  maxLength: 10,\n  provider: function(done) {\n    done(getImage())\n  }\n})\n\nvar saveHistory = function() {\n  history.save()\n}\n\nvar goBackInHistory = function() {\n  history.undo(setImage)\n}\n\nvar goForthInHistory = function() {\n  history.redo(setImage)\n}\n\nwindow.goback = goBackInHistory\nwindow.gofont = goForthInHistory\n\nvar getImage = function() {\n  return canvas.toDataURL('image/png')\n}\n\nvar setImage = function(src) {\n  var ctx = getContext()\n  var img = new Image()\n  var oldGCO = ctx.globalCompositeOperation\n  img.onload = function() {\n    ctx.globalCompositeOperation = \"source-over\"\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n    ctx.globalCompositeOperation = oldGCO\n  }\n  img.src = src\n}\n\nvar getContext = function() {\n  return canvas && canvas.getContext && canvas.getContext('2d') ? canvas.getContext('2d') : null;\n}\n\nsaveHistory()\n  \n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./public/javascripts/apps/drawingboard/src/index.js\n ** module id = 0\n ** module chunks = 0\n **/","\nvar isColor = function(string) {\n\tif (!string || !string.length) return false;\n\treturn (/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i).test(string) || $.inArray(string.substring(0, 3), ['rgb', 'hsl']) !== -1;\n};\n\n/**\n * Packs an RGB color into a single integer.\n */\nvar RGBToInt = function(r, g, b) {\n\tvar c = 0;\n\tc |= (r & 255) << 16;\n\tc |= (g & 255) << 8;\n\tc |= (b & 255);\n\treturn c;\n};\n\n/**\n * Returns informations on the pixel located at (x,y).\n */\nvar pixelAt = function(image, x, y) {\n\tvar i = (y * image.width + x) * 4;\n\tvar c = DrawingBoard.Utils.RGBToInt(\n\t\timage.data[i],\n\t\timage.data[i + 1],\n\t\timage.data[i + 2]\n\t);\n\n\treturn [\n\t\ti, // INDEX\n\t\tx, // X\n\t\ty, // Y\n\t\tc  // COLOR\n\t];\n};\n\n/**\n * Compares two colors with the given tolerance (between 0 and 255).\n */\nvar compareColors = function(a, b, tolerance) {\n\tif (tolerance === 0) {\n\t\treturn (a === b);\n\t}\n\n\tvar ra = (a >> 16) & 255, rb = (b >> 16) & 255,\n\t\tga = (a >> 8) & 255, gb = (b >> 8) & 255,\n\t\tba = a & 255, bb = b & 255;\n\n\treturn (Math.abs(ra - rb) <= tolerance)\n\t\t&& (Math.abs(ga - gb) <= tolerance)\n\t\t&& (Math.abs(ba - bb) <= tolerance);\n};\n\n(function() {\n\tvar lastTime = 0;\n\tvar vendors = ['ms', 'moz', 'webkit', 'o'];\n\tfor(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n\t\twindow.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\n\t\twindow.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];\n\t}\n}());\n\nmodule.exports = {\n  isColor: isColor,\n  RGBToInt: RGBToInt,\n  pixelAt: pixelAt,\n  compareColors: compareColors\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./public/javascripts/apps/drawingboard/utils.js\n ** module id = 1\n ** module chunks = 0\n **/","/**\n * MicroEvent - to make any js object an event emitter (server or browser)\n * \n * - pure javascript - server compatible, browser compatible\n * - dont rely on the browser doms\n * - super simple - you get it immediatly, no mistery, no magic involved\n *\n * - create a MicroEventDebug with goodies to debug\n *   - make it safer to use\n*/\n\nvar MicroEvent\t= function(){}\nMicroEvent.prototype\t= {\n\tbind\t: function(event, fct){\n\t\tthis._events = this._events || {};\n\t\tthis._events[event] = this._events[event]\t|| [];\n\t\tthis._events[event].push(fct);\n\t},\n\tunbind\t: function(event, fct){\n\t\tthis._events = this._events || {};\n\t\tif( event in this._events === false  )\treturn;\n\t\tthis._events[event].splice(this._events[event].indexOf(fct), 1);\n\t},\n\ttrigger\t: function(event /* , args... */){\n\t\tthis._events = this._events || {};\n\t\tif( event in this._events === false  )\treturn;\n\t\tfor(var i = 0; i < this._events[event].length; i++){\n\t\t\tthis._events[event][i].apply(this, Array.prototype.slice.call(arguments, 1))\n\t\t}\n\t}\n};\n\n/**\n * mixin will delegate all MicroEvent.js function in the destination object\n *\n * - require('MicroEvent').mixin(Foobar) will make Foobar able to use MicroEvent\n *\n * @param {Object} the object which will support MicroEvent\n*/\nMicroEvent.mixin\t= function(destObject){\n\tvar props\t= ['bind', 'unbind', 'trigger'];\n\tfor(var i = 0; i < props.length; i ++){\n\t\tdestObject.prototype[props[i]]\t= MicroEvent.prototype[props[i]];\n\t}\n}\n\n// export in common js\nif( typeof module !== \"undefined\" && ('exports' in module)){\n\tmodule.exports\t= MicroEvent\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./public/javascripts/apps/drawingboard/~/microevent/microevent.js\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tmodule.children = [];\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** (webpack)/buildin/module.js\n ** module id = 3\n ** module chunks = 0\n **/","(function() {\n\t\n'use strict';\n\n/**\n * SimpleUndo is a very basic javascript undo/redo stack for managing histories of basically anything.\n * \n * options are: {\n * \t* `provider` : required. a function to call on `save`, which should provide the current state of the historized object through the given \"done\" callback\n * \t* `maxLength` : the maximum number of items in history\n * \t* `opUpdate` : a function to call to notify of changes in history. Will be called on `save`, `undo`, `redo` and `clear`\n * }\n * \n */\nvar SimpleUndo = function(options) {\n\t\n\tvar settings = options ? options : {};\n\tvar defaultOptions = {\n\t\tprovider: function() {\n\t\t\tthrow new Error(\"No provider!\");\n\t\t},\n\t\tmaxLength: 30,\n\t\tonUpdate: function() {}\n\t};\n\t\n\tthis.provider = (typeof settings.provider != 'undefined') ? settings.provider : defaultOptions.provider;\n\tthis.maxLength = (typeof settings.maxLength != 'undefined') ? settings.maxLength : defaultOptions.maxLength;\n\tthis.onUpdate = (typeof settings.onUpdate != 'undefined') ? settings.onUpdate : defaultOptions.onUpdate;\n\t\n\tthis.initialItem = null;\n\tthis.clear();\n};\n\nfunction truncate (stack, limit) {\n\twhile (stack.length > limit) {\n\t\tstack.shift();\n\t}\n}\n\nSimpleUndo.prototype.initialize = function(initialItem) {\n\tthis.stack[0] = initialItem;\n\tthis.initialItem = initialItem;\n};\n\n\nSimpleUndo.prototype.clear = function() {\n\tthis.stack = [this.initialItem];\n\tthis.position = 0;\n\tthis.onUpdate();\n};\n\nSimpleUndo.prototype.save = function() {\n\tthis.provider(function(current) {\n\t\ttruncate(this.stack, this.maxLength);\n\t\tthis.position = Math.min(this.position,this.stack.length - 1);\n\t\t\n\t\tthis.stack = this.stack.slice(0, this.position + 1);\n\t\tthis.stack.push(current);\n\t\tthis.position++;\n\t\tthis.onUpdate();\n\t}.bind(this));\n};\n\nSimpleUndo.prototype.undo = function(callback) {\n\tif (this.canUndo()) {\n\t\tvar item =  this.stack[--this.position];\n\t\tthis.onUpdate();\n\t\t\n\t\tif (callback) {\n\t\t\tcallback(item);\n\t\t}\n\t}\n};\n\nSimpleUndo.prototype.redo = function(callback) {\n\tif (this.canRedo()) {\n\t\tvar item = this.stack[++this.position];\n\t\tthis.onUpdate();\n\t\t\n\t\tif (callback) {\n\t\t\tcallback(item);\n\t\t}\n\t}\n};\n\nSimpleUndo.prototype.canUndo = function() {\n\treturn this.position > 0;\n};\n\nSimpleUndo.prototype.canRedo = function() {\n\treturn this.position < this.count();\n};\n\nSimpleUndo.prototype.count = function() {\n\treturn this.stack.length - 1; // -1 because of initial item\n};\n\n\n\n\n\n//exports\n// node module\nif (typeof module != 'undefined') {\n\tmodule.exports = SimpleUndo;\n}\n\n// browser global\nif (typeof window != 'undefined') {\n\twindow.SimpleUndo = SimpleUndo;\n}\n\n})();\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./public/javascripts/apps/drawingboard/~/simple-undo/lib/simple-undo.js\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}