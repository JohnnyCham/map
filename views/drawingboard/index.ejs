<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
  <title><%= title %></title>
  <link href="/stylesheets/drawingboard.css" rel="stylesheet">
  <script src="/javascripts/common/sendMassage.js" type="text/javascript"></script>
  <script src="/javascripts/common/ryToast.js" type="text/javascript"></script>
</head>
<body>
  <%- include('../common/toast', {confirm: true, cancel: true, id:'alert_delete_message'}); %>
  <%- include('../common/toast', {confirm: true, cancel: true, text: true, id:'alert_upload'}); %>
  <div class="container">
    <div class="drawingboard_container">
      <canvas id="drawingboard" width="400px" height="400px"></canvas>
    </div>
    <div class="controls">
      <button id="goback_button" class="control_button" onclick="goback()">撤销</button>
      <div class="tools_container">
        <div class="tool">
           <div class="pencil" id="pencil">
            <p>画笔</p>
           </div>
           <div class="eraser" id="eraser">
             <p>橡皮</p>
           </div>
        </div>
        <div class="size">
         <div class="size_item" id="small_size">
          <div class="size_icon"></div>
         </div>
         <div class="size_item" id="middle_size">
          <div class="size_icon"></div>
         </div>
         <div class="size_item" id="large_size">
          <div class="size_icon"></div>
         </div>
        </div>
      </div>
      <button class="control_button" id="clear_button" onclick="clearArtboard()">清除</button>
      <div class="control_button" id="upload_button" onclick="clickUpload()"> 
        <img class="upload_button_icon" src="/images/upload_button_icon.png" alt="">
        <p>上传</p>
      </div>
    </div>
  </div>
  <script src="/javascripts/dist/drawingboard.js" type="text/javascript"></script>
  <script type="text/javascript">
    function clearArtboard() {
      showRyToast('alert_delete_message', '是否继续删除', {text: '删除', onclick: 'confirmClearCanvas()'}, {text: '取消', onclick: 'hideDeleMessage()'})
    }
    function hideDeleMessage() {
      hideRyToast('alert_delete_message')
    }
    function confirmClearCanvas() {
      clearCanvas()
      hideDeleMessage()
    }
    function clickUpload() {
      showRyToast('alert_upload', '给这只猫起个名字吧', {text: '上传作品', onclick: 'confirmUploadImage()'},  {text: '取消', onclick: 'hideUploadAlert()'})
    }

    function hideUploadAlert() {
      hideRyToast('alert_upload')
    }

    function confirmUploadImage() {
      var textContainer = document.getElementsByClassName('renyan_mask_text')[0]
      var username = textContainer.value
      if (!username || username == '') username = '不知名的猫'
      uploadImage(username)
      hideUploadAlert()
    }
</script>
</body>
</html>
